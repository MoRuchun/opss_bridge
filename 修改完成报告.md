# bridge_model_v1.ipynb ä¿®æ”¹å®ŒæˆæŠ¥å‘Š

## ä¿®æ”¹æ—¶é—´
2024å¹´ï¼ˆæ ¹æ®ç³»ç»Ÿæ—¶é—´ï¼‰

## ä¿®æ”¹å†…å®¹

### âœ… å·²å®Œæˆä¿®æ”¹

#### 1. ä¿®æ”¹ `define_deck_nodes` å‡½æ•°å®šä¹‰

**ä½ç½®**: Cell 6

**ä¿®æ”¹å‰**:
```python
def define_deck_nodes(num_spans: int,
                      span_length: float,
                      nodes_per_span: int,
                      col_height: float,
                      start_tag = 1000):
    # ...
    z = float(col_height)  # âŒ é”™è¯¯ï¼šåªä½¿ç”¨äº†æŸ±é«˜
```

**ä¿®æ”¹å**:
```python
def define_deck_nodes(num_spans: int,
                      span_length: float,
                      nodes_per_span: int,
                      col_height: float,
                      capbeam_depth: float,                    # âœ… æ–°å¢
                      bearing_height: float = 0.1,             # âœ… æ–°å¢
                      girder_centroid_height: float = 1.24,    # âœ… æ–°å¢
                      start_tag = 1000):
    # ...
    # âœ… æ­£ç¡®ï¼šä¸»æ¢Zåæ ‡ = æŸ±é«˜ + ç›–æ¢é«˜åº¦ + æ”¯åº§é«˜åº¦ + ä¸»æ¢å½¢å¿ƒé«˜åº¦
    z = float(col_height) + float(capbeam_depth) + float(bearing_height) + float(girder_centroid_height)
```

#### 2. ä¿®æ”¹ `define_deck_nodes` å‡½æ•°è°ƒç”¨

**ä½ç½®**: Cell 25

**ä¿®æ”¹å‰**:
```python
deck_res = define_deck_nodes(num_spans=num_spans,
                             span_length=span_length,
                             nodes_per_span=nodes_per_span,
                             col_height=col_height)
```

**ä¿®æ”¹å**:
```python
deck_res = define_deck_nodes(num_spans=num_spans,
                             span_length=span_length,
                             nodes_per_span=nodes_per_span,
                             col_height=col_height,
                             capbeam_depth=CAPBEAM_DESIGN.depth,      # âœ… æ–°å¢
                             bearing_height=0.1,                       # âœ… æ–°å¢
                             girder_centroid_height=1.24)              # âœ… æ–°å¢
```

---

## ä¿®æ”¹æ•ˆæœ

### ä¸»æ¢Zåæ ‡è®¡ç®—å¯¹æ¯”

| é¡¹ç›® | ä¿®æ”¹å‰ | ä¿®æ”¹å | TCLåŸå§‹ä»£ç  |
|------|--------|--------|-------------|
| **è®¡ç®—å…¬å¼** | `z = col_height` | `z = col_height + capbeam_depth + bearing_height + girder_centroid_height` | `ph1 + CHSec + bh + gxingxinh` |
| **æ•°å€¼** | 8.0m | 10.84m | çº¦13.34m* |
| **çŠ¶æ€** | âŒ é”™è¯¯ | âœ… æ­£ç¡® | âœ… å‚è€ƒæ ‡å‡† |

*æ³¨ï¼šTCLä¸­ ph1=10.5mï¼Œä¸Pythonä¸­ col_height=8.0m å­˜åœ¨å·®å¼‚ï¼Œè¿™å¯èƒ½æ˜¯æœ‰æ„ä¸ºä¹‹çš„å‚æ•°è°ƒæ•´ã€‚

### å‚æ•°å¯¹ç…§è¡¨

| å‚æ•°åç§° | Pythonå‚æ•° | TCLå˜é‡ | é»˜è®¤å€¼ | è¯´æ˜ |
|---------|-----------|---------|--------|------|
| æŸ±é«˜ | `col_height` | `ph1` | 8.0m (Python) / 10.5m (TCL) | å¢©æŸ±é«˜åº¦ |
| ç›–æ¢é«˜åº¦ | `capbeam_depth` | `CHSec` | 1.5m | ç›–æ¢æˆªé¢é«˜åº¦ |
| æ”¯åº§é«˜åº¦ | `bearing_height` | `bh` | 0.1m | æ”¯åº§é«˜åº¦ |
| ä¸»æ¢å½¢å¿ƒé«˜åº¦ | `girder_centroid_height` | `gxingxinh` | 1.24m | ä¸»æ¢å½¢å¿ƒåˆ°åº•éƒ¨çš„é«˜åº¦ |

---

## éªŒè¯ç»“æœ

### âœ… å‡½æ•°å®šä¹‰éªŒè¯
- å‚æ•°ç­¾åæ­£ç¡®æ·»åŠ äº† `capbeam_depth`, `bearing_height`, `girder_centroid_height`
- Zåæ ‡è®¡ç®—å…¬å¼æ­£ç¡®ä¿®æ”¹
- æ–‡æ¡£å­—ç¬¦ä¸²å·²æ›´æ–°ï¼Œè¯´æ˜äº†ä¸TCLä»£ç çš„å¯¹åº”å…³ç³»

### âœ… å‡½æ•°è°ƒç”¨éªŒè¯
- è°ƒç”¨æ—¶æ­£ç¡®ä¼ å…¥äº†æ–°å¢çš„ä¸‰ä¸ªå‚æ•°
- å‚æ•°å€¼ä¸TCLåŸå§‹ä»£ç ä¿æŒä¸€è‡´

### âœ… ä»£ç ä¸€è‡´æ€§éªŒè¯
```bash
# éªŒè¯å‘½ä»¤
grep -n "girder_centroid_height" bridge_model_v1.ipynb
```

ç»“æœï¼š
- Line 179: å‡½æ•°å®šä¹‰ä¸­çš„å‚æ•°å£°æ˜ âœ…
- Line 208: Zåæ ‡è®¡ç®—ä¸­ä½¿ç”¨ âœ…
- Line 998: å‡½æ•°è°ƒç”¨ä¸­ä¼ å‚ âœ…

---

## å…³äºç›–æ¢Zåæ ‡çš„è¯´æ˜

ç»è¿‡åˆ†æï¼Œ**ç›–æ¢Zåæ ‡ä¸éœ€è¦ä¿®æ”¹**ï¼ŒåŸå› å¦‚ä¸‹ï¼š

1. **TCLåŸå§‹ä»£ç **: `z_cap = ph1 + CHSec` (å¢©é¡¶é«˜åº¦ + ç›–æ¢é«˜åº¦)
2. **Pythonä»£ç **: `z_cap = max(å¢©é¡¶é«˜åº¦) + design.depth`
3. **ç»“è®º**: ä¸¤è€…é€»è¾‘ä¸€è‡´ï¼Œç›–æ¢èŠ‚ç‚¹ä½äºç›–æ¢**é¡¶éƒ¨**ï¼Œä¸æ˜¯ä¸­å¿ƒ

---

## åç»­å»ºè®®

1. **è¿è¡Œæµ‹è¯•**: å»ºè®®åœ¨ä¿®æ”¹åè¿è¡Œå®Œæ•´çš„å»ºæ¨¡ä»£ç ï¼ŒéªŒè¯èŠ‚ç‚¹åæ ‡æ˜¯å¦æ­£ç¡®
2. **å¯è§†åŒ–æ£€æŸ¥**: ä½¿ç”¨ `opsvis` å¯è§†åŒ–æ¨¡å‹ï¼Œæ£€æŸ¥ä¸»æ¢ã€ç›–æ¢ã€å¢©æŸ±çš„ç›¸å¯¹ä½ç½®å…³ç³»
3. **å‚æ•°æ ¸å¯¹**: ç¡®è®¤ `col_height=8.0m` ä¸TCLä¸­ `ph1=10.5m` çš„å·®å¼‚æ˜¯å¦ç¬¦åˆé¢„æœŸ

---

## ä¿®æ”¹æ–‡ä»¶æ¸…å•

- âœ… `bridge_model_v1.ipynb` - ä¸»è¦ä¿®æ”¹æ–‡ä»¶
- ğŸ“„ `åæ ‡ä¿®æ­£å»ºè®®.md` - åˆ†ææ–‡æ¡£
- ğŸ“„ `ä¿®æ”¹å®ŒæˆæŠ¥å‘Š.md` - æœ¬æ–‡æ¡£
- ğŸ—‘ï¸ `fix_notebook.py` - ä¸´æ—¶è„šæœ¬ï¼ˆå¯åˆ é™¤ï¼‰
- ğŸ—‘ï¸ `fix_notebook_v2.py` - ä¸´æ—¶è„šæœ¬ï¼ˆå¯åˆ é™¤ï¼‰
- ğŸ—‘ï¸ `fix_call.py` - ä¸´æ—¶è„šæœ¬ï¼ˆå¯åˆ é™¤ï¼‰
